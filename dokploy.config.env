# ============================================================================
# Configuración de Dokploy
# ============================================================================
# Este archivo documenta la configuración recomendada para Dokploy
# No es necesario incluirlo en el repositorio, es solo referencia

# ============================================================================
# VARIABLES DE ENTORNO PARA DOKPLOY
# ============================================================================
# Copia estas variables en el panel de Dokploy → Environment Variables

# Puerto externo (Dokploy manejará el routing)
EXTERNAL_PORT=3000

# Seguridad - CAMBIAR ESTO
API_KEY=GENERA_UNA_CLAVE_SEGURA_AQUI

# Redis
REDIS_HOST=redis
REDIS_PORT=6379

# Configuración
NODE_ENV=production
TZ=America/Caracas
PORT=3000

# Logs
LOG_LEVEL=info
FILE_LOGGING=true
LOG_DIR=./logs

# WhatsApp / Baileys
BROWSER_NAME=Delphi Client
BROWSER_VERSION=1.0.0
AUTO_RECONNECT=true
KEEP_ALIVE_INTERVAL=10000
OPERATION_TIMEOUT=60

# Rate Limiting
MAX_REQUESTS=100
RATE_LIMIT_WINDOW=15

# CORS
ALLOWED_ORIGINS=*

# ============================================================================
# VOLÚMENES PERSISTENTES
# ============================================================================
# Configurar en Dokploy → Volumes

# Sesiones de WhatsApp (IMPORTANTE - debe persistir)
./auth_info:/app/auth_info

# Logs
./logs:/app/logs

# ============================================================================
# CONFIGURACIÓN DE DOMINIO
# ============================================================================
# En Dokploy → Domains

# Ejemplo:
# whatsapp-api.tudominio.com

# Habilitar SSL: ✅ (automático con Let's Encrypt)

# ============================================================================
# HEALTH CHECK
# ============================================================================
# Dokploy detectará automáticamente el health check del Dockerfile
# Endpoint: http://localhost:3000/session/status

# ============================================================================
# RECURSOS RECOMENDADOS
# ============================================================================
# CPU: 1-2 vCPUs
# RAM: 2-4 GB
# Disco: 10-20 GB

# ============================================================================
# COMANDOS ÚTILES PARA GENERAR SECRETS
# ============================================================================

# Generar API_KEY seguro:
# openssl rand -hex 32

# O en PowerShell:
# -join ((48..57) + (65..90) + (97..122) | Get-Random -Count 32 | % {[char]$_})

# ============================================================================
# NOTAS IMPORTANTES
# ============================================================================

# 1. NUNCA subas este archivo con valores reales al repositorio
# 2. Usa variables de entorno en Dokploy para valores sensibles
# 3. La carpeta auth_info/ debe ser un volumen persistente
# 4. Configura backups automáticos de auth_info/
# 5. Monitorea los logs regularmente
# 6. Configura alertas en Dokploy para downtime

# ============================================================================
# WEBHOOK DE GITHUB (Auto-deploy)
# ============================================================================

# 1. En Dokploy, copia el Webhook URL
# 2. En GitHub → Settings → Webhooks → Add webhook
# 3. Payload URL: [URL de Dokploy]
# 4. Content type: application/json
# 5. Events: Just the push event
# 6. Active: ✅

# ============================================================================
# TROUBLESHOOTING
# ============================================================================

# Ver logs en tiempo real:
# Dokploy Panel → Logs → Real-time

# Reiniciar aplicación:
# Dokploy Panel → Restart

# Rebuild completo:
# Dokploy Panel → Rebuild

# Acceder al contenedor:
# SSH al servidor → docker exec -it whatsapp-api sh

# Ver uso de recursos:
# Dokploy Panel → Metrics
